<?xml version="1.0" encoding="utf-8"?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="R3Ext.SampleApp.DDLifecyclePage"
             Title="Lifecycle">
    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="16">
            <Label Text="DynamicData Lifecycle Operators"
                   Style="{StaticResource Headline}" />
            <Label Text="Demonstrates ExpireAfter, DisposeMany, and LimitSizeTo."
                   TextColor="Gray" />

            <!-- LimitSizeTo Demo -->
            <Frame BorderColor="Purple" Padding="12">
                <VerticalStackLayout Spacing="8">
                    <Label Text="LimitSizeTo (Max 5 Items)" FontAttributes="Bold" />
                    <Label Text="Oldest items automatically removed when limit exceeded" FontSize="12" TextColor="Gray" />
                    <Grid ColumnDefinitions="*,Auto" ColumnSpacing="8">
                        <Entry x:Name="LimitEntry" Placeholder="Enter text" />
                        <Button Text="Add" Grid.Column="1" Clicked="OnAddLimited" />
                    </Grid>
                    <Button Text="Add 10 Random Items" Clicked="OnAddMultipleLimited" />
                    <Label x:Name="LimitCountLabel" Text="Count: 0" FontAttributes="Bold" />
                    <CollectionView x:Name="LimitView" MaximumHeightRequest="150">
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Label Text="{Binding}" Padding="8" />
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </VerticalStackLayout>
            </Frame>

            <!-- DisposeMany Demo -->
            <Frame BorderColor="Red" Padding="12">
                <VerticalStackLayout Spacing="8">
                    <Label Text="DisposeMany (Auto-Dispose IDisposable Items)" FontAttributes="Bold" />
                    <Label Text="Items are disposed when removed from collection" FontSize="12" TextColor="Gray" />
                    <Grid ColumnDefinitions="*,*" ColumnSpacing="8">
                        <Button Text="Add Disposable" Clicked="OnAddDisposable" />
                        <Button Text="Clear All" Grid.Column="1" Clicked="OnClearDisposables" />
                    </Grid>
                    <Label x:Name="DisposableCountLabel" Text="Active: 0, Disposed: 0" FontAttributes="Bold" />
                    <Label x:Name="DisposableLogLabel" Text="Log:" FontSize="12" />
                    <ScrollView MaximumHeightRequest="120">
                        <Label x:Name="DisposableLog" Text="" FontSize="11" FontFamily="Courier" />
                    </ScrollView>
                </VerticalStackLayout>
            </Frame>
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
